--========================================================
-- üê• Jeab Hub | V.1  (Small UI 50% + Robust Scylla Detect + Mobile Drag)
--========================================================

local Players = game:GetService("Players")
local RS      = game:GetService("ReplicatedStorage")
local UIS     = game:GetService("UserInputService")
local LP      = Players.LocalPlayer

--========================
-- CONFIG
--========================
local NAME_SUNDIAL = "Sundial Totem"
local NAME_AURORA  = "Aurora Totem"
local KEYWORD_ROD  = "Rod Of The Zenith"

--========================
-- STATE
--========================
local scyllaModeOn  = false
local auroraModeOn  = false
local debugOn       = false

local scyllaActive  = false
local cycleValue    = nil         -- StringValue Day/Night/Both (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
local isDay         = true        -- fallback ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ cycle

-- anti-spam debug
local lastLog, lastLogTime = "", 0
local function now() return os.clock() end

--========================
-- UTIL: Equip / Use
--========================
local function equipItem(keyword)
    local char = LP.Character or LP.CharacterAdded:Wait()
    local hum  = char:WaitForChild("Humanoid")

    local tool = char:FindFirstChildOfClass("Tool")
    if tool and string.find(tool.Name, keyword) then
        return true
    end

    local bp = LP:WaitForChild("Backpack")
    for _, t in ipairs(bp:GetChildren()) do
        if t:IsA("Tool") and string.find(t.Name, keyword) then
            hum:EquipTool(t)
            return true
        end
    end
    return false
end

local function useItem(namePart)
    local char = LP.Character or LP.CharacterAdded:Wait()
    local hum  = char:WaitForChild("Humanoid")

    local tool = char:FindFirstChildOfClass("Tool")
    if tool and string.find(tool.Name, namePart) then
        tool:Activate()
        return true
    end

    local bp = LP:WaitForChild("Backpack")
    for _, t in ipairs(bp:GetChildren()) do
        if t:IsA("Tool") and string.find(t.Name, namePart) then
            hum:EquipTool(t)
            task.wait()
            t:Activate()
            return true
        end
    end
    return false
end

--========================
-- UI (‡∏¢‡πà‡∏≠ 50% ‡∏à‡∏≤‡∏Å‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤)
--========================
local gui = Instance.new("ScreenGui")
gui.Name = "JeabHub"
gui.ResetOnSpawn = false
gui.Parent = LP:WaitForChild("PlayerGui")

-- ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏•‡πÇ‡∏Å‡πâ üê• (‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢, ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Hub)
local logoBtn = Instance.new("TextButton")
logoBtn.Parent = gui
logoBtn.Size = UDim2.new(0, 40, 0, 40)
logoBtn.Position = UDim2.new(0, 10, 0.5, -20)
logoBtn.Text = "üê•"
logoBtn.TextSize = 22
logoBtn.BackgroundTransparency = 1
logoBtn.ZIndex = 50

-- ‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á)
local main = Instance.new("Frame")
main.Parent = gui
main.Size = UDim2.new(0, 480, 0, 280) -- << ‡∏¢‡πà‡∏≠
main.Position = UDim2.new(0.5, -240, 0.48, -140)
main.BackgroundColor3 = Color3.fromRGB(255, 232, 180)
main.BorderSizePixel = 0
main.Active = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 12)

local function makeDraggable(panel, handle)
    handle = handle or panel
    local dragging, dragStart, startPos = false, nil, nil

    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = panel.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)

    handle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement
        or input.UserInputType == Enum.UserInputType.Touch then
            if dragging then
                local delta = input.Position - dragStart
                panel.Position = UDim2.new(
                    startPos.X.Scale, startPos.X.Offset + delta.X,
                    startPos.Y.Scale, startPos.Y.Offset + delta.Y
                )
            end
        end
    end)
end

-- Top bar (‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡∏û‡∏≠‡∏î‡∏µ ‡πÜ)
local top = Instance.new("Frame", main)
top.Size = UDim2.new(1, 0, 0, 40)
top.BackgroundColor3 = Color3.fromRGB(255, 200, 120)
top.BorderSizePixel = 0
local pad = Instance.new("UIPadding", top); pad.PaddingLeft = UDim.new(0, 12)

local title = Instance.new("TextLabel", top)
title.Size = UDim2.new(1, -12, 1, 0)
title.BackgroundTransparency = 1
title.TextXAlignment = Enum.TextXAlignment.Left
title.Text = "üê£  Jeab Hub | V.1"
title.Font = Enum.Font.SourceSansBold
title.TextSize = 20
title.TextColor3 = Color3.fromRGB(90, 60, 20)

makeDraggable(main, top)         -- ‡∏•‡∏≤‡∏Å Hub ‡πÑ‡∏î‡πâ
logoBtn.MouseButton1Click:Connect(function()
    main.Visible = not main.Visible
end)

-- ‡πÇ‡∏Ñ‡∏£‡∏á 3 ‡∏™‡πà‡∏ß‡∏ô
local left = Instance.new("Frame", main)
left.Size = UDim2.new(0, 130, 1, -40)
left.Position = UDim2.new(0, 0, 0, 40)
left.BackgroundColor3 = Color3.fromRGB(255, 215, 150)
left.BorderSizePixel = 0
local leftPad = Instance.new("UIPadding", left); leftPad.PaddingTop = UDim.new(0, 8)

local leftScroll = Instance.new("ScrollingFrame", left)
leftScroll.Size = UDim2.new(1, 0, 1, -8)
leftScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
leftScroll.BorderSizePixel = 0
leftScroll.BackgroundTransparency = 1
leftScroll.ScrollBarThickness = 6

local leftList = Instance.new("UIListLayout", leftScroll)
leftList.Padding = UDim.new(0, 6)
leftList.SortOrder = Enum.SortOrder.LayoutOrder
leftList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    leftScroll.CanvasSize = UDim2.new(0,0,0,leftList.AbsoluteContentSize.Y + 8)
end)

local divider = Instance.new("Frame", main)
divider.Size = UDim2.new(0, 2, 1, -40)
divider.Position = UDim2.new(0, 130, 0, 40)
divider.BackgroundColor3 = Color3.fromRGB(190, 150, 90)
divider.BorderSizePixel = 0

local content = Instance.new("Frame", main)
content.Size = UDim2.new(1, -132, 1, -40)
content.Position = UDim2.new(0, 132, 0, 40)
content.BackgroundColor3 = Color3.fromRGB(255, 240, 210)
content.BorderSizePixel = 0

--========================
-- DEBUG PANEL (‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏î‡∏¥‡∏°, ‡πÅ‡∏Å‡πâ‡πÅ‡∏Ñ‡πà logic)
--========================
local dbg = Instance.new("Frame", gui)
dbg.Size = UDim2.new(0, 320, 0, 200) -- ‡∏¢‡πà‡∏≠
dbg.Position = UDim2.new(0.6, 0, 0.18, 0)
dbg.BackgroundColor3 = Color3.fromRGB(255, 232, 190)
dbg.Visible = false
dbg.BorderSizePixel = 0
Instance.new("UICorner", dbg).CornerRadius = UDim.new(0, 10)
makeDraggable(dbg) -- ‡∏•‡∏≤‡∏Å debug ‡πÑ‡∏î‡πâ

local dbgTop = Instance.new("Frame", dbg)
dbgTop.Size = UDim2.new(1, 0, 0, 32)
dbgTop.BackgroundColor3 = Color3.fromRGB(255, 206, 140)
dbgTop.BorderSizePixel = 0

local dbgTitle = Instance.new("TextLabel", dbgTop)
dbgTitle.Size = UDim2.new(1, -70, 1, 0)
dbgTitle.Position = UDim2.new(0, 10, 0, 0)
dbgTitle.BackgroundTransparency = 1
dbgTitle.Text = "üîé Scylla Debug Log"
dbgTitle.Font = Enum.Font.SourceSansBold
dbgTitle.TextSize = 16
dbgTitle.TextColor3 = Color3.fromRGB(90, 60, 20)
dbgTitle.TextXAlignment = Enum.TextXAlignment.Left

local copyBtn = Instance.new("TextButton", dbgTop)
copyBtn.Size = UDim2.new(0, 64, 0, 24)
copyBtn.Position = UDim2.new(1, -74, 0.5, -12)
copyBtn.Text = "Copy"
copyBtn.Font = Enum.Font.SourceSansBold
copyBtn.TextSize = 14
copyBtn.TextColor3 = Color3.new(1,1,1)
copyBtn.BackgroundColor3 = Color3.fromRGB(100,180,100)
Instance.new("UICorner", copyBtn).CornerRadius = UDim.new(0, 8)

local dbgScroll = Instance.new("ScrollingFrame", dbg)
dbgScroll.Size = UDim2.new(1, -8, 1, -40)
dbgScroll.Position = UDim2.new(0, 4, 0, 36)
dbgScroll.BackgroundTransparency = 1
dbgScroll.ScrollBarThickness = 6
dbgScroll.CanvasSize = UDim2.new(0,0,0,0)

local dbgList = Instance.new("UIListLayout", dbgScroll)
dbgList.SortOrder = Enum.SortOrder.LayoutOrder
dbgList.Padding = UDim.new(0, 2)
dbgList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    dbgScroll.CanvasSize = UDim2.new(0,0,0,dbgList.AbsoluteContentSize.Y + 6)
end)

local debugBuffer, MAX_LOG = {}, 120
local function log(msg)
    -- ‡∏Å‡∏±‡∏ô‡∏™‡πÅ‡∏õ‡∏°; ‡∏ã‡πâ‡∏≥‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1.2 ‡∏ß‡∏¥ ‡πÑ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå
    if msg == lastLog and (now() - lastLogTime) < 1.2 then return end
    lastLog, lastLogTime = msg, now()

    if not debugOn then return end
    table.insert(debugBuffer, msg)
    if #debugBuffer > MAX_LOG then
        table.remove(debugBuffer,1)
        local first = dbgScroll:FindFirstChildWhichIsA("TextLabel"); if first then first:Destroy() end
    end
    local line = Instance.new("TextLabel")
    line.Size = UDim2.new(1, -4, 0, 18)
    line.BackgroundTransparency = 1
    line.TextXAlignment = Enum.TextXAlignment.Left
    line.Font = Enum.Font.SourceSans
    line.TextSize = 15
    line.TextColor3 = Color3.fromRGB(70, 50, 30)
    line.Text = msg
    line.Parent = dbgScroll
    dbgScroll.CanvasPosition = Vector2.new(0, math.max(0, dbgScroll.AbsoluteCanvasSize.Y - dbgScroll.AbsoluteWindowSize.Y))
end

copyBtn.MouseButton1Click:Connect(function()
    if setclipboard then setclipboard(table.concat(debugBuffer,"\n")); log("‚úÖ Debug copied.") else log("‚ùå setclipboard ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ") end
end)

--========================
-- SIDEBAR + PAGES
--========================
local function makeTabButton(text)
    local b = Instance.new("TextButton")
    b.Parent = leftScroll
    b.Size = UDim2.new(1, -16, 0, 30)
    b.Position = UDim2.new(0, 8, 0, 0)
    b.BackgroundColor3 = Color3.fromRGB(255, 226, 176)
    b.Text = text
    b.Font = Enum.Font.SourceSansBold
    b.TextSize = 16
    b.TextColor3 = Color3.fromRGB(90, 60, 20)
    b.AutoButtonColor = true
    Instance.new("UICorner", b).CornerRadius = UDim.new(0, 8)
    return b
end

local tabs = {"‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ","‡πÄ‡∏°‡πá‡∏Å‡∏Å‡∏≤‡πÇ‡∏•‡∏î‡πâ‡∏ß‡∏ô","‡∏ã‡∏±‡∏ô‡πÑ‡∏≠‡∏î‡∏≠","‡∏´‡∏°‡∏∂‡∏Å‡∏¢‡πä‡∏≤‡∏Å‡∏´‡∏°‡∏∂‡∏Å‡∏õ‡∏µ‡∏®‡∏≤‡∏à"}
local tabFrames = {}
for _, name in ipairs(tabs) do
    local btn = makeTabButton(name)
    local page = Instance.new("Frame", content)
    page.Size = UDim2.new(1, 0, 1, 0)
    page.BackgroundTransparency = 1
    page.Visible = false
    tabFrames[name] = page
    btn.MouseButton1Click:Connect(function()
        for _, f in pairs(tabFrames) do f.Visible = false end
        page.Visible = true
    end)
end
tabFrames["‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ"].Visible = true

--========================
-- PAGE: ‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ
--========================
local scPage = tabFrames["‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ"]

local note = Instance.new("TextLabel", scPage)
note.Position = UDim2.new(0, 18, 0, 8)
note.Size = UDim2.new(1, -36, 0, 24)
note.BackgroundTransparency = 1
note.Text = "‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Rod Of The Zenith"
note.Font = Enum.Font.SourceSansItalic
note.TextSize = 16
note.TextColor3 = Color3.fromRGB(100, 80, 40)
note.TextXAlignment = Enum.TextXAlignment.Left

local function makeModeButton(parent, text, color, y)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(0, 300, 0, 44)
    btn.Position = UDim2.new(0, 18, 0, y)
    btn.BackgroundColor3 = color
    btn.TextColor3 = Color3.new(1,1,1)
    btn.TextSize = 18
    btn.Font = Enum.Font.SourceSansBold
    btn.Text = text
    btn.AutoButtonColor = true
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 12)
    return btn
end

local scyllaBtn = makeModeButton(scPage, "‚öîÔ∏è Scylla Mode : OFF", Color3.fromRGB(55,55,55), 42)
local auroraBtn = makeModeButton(scPage, "üåå Aurora Mode : OFF", Color3.fromRGB(40,140,70), 96)

local dbgBtn = Instance.new("TextButton", scPage)
dbgBtn.Size = UDim2.new(0, 220, 0, 36)
dbgBtn.Position = UDim2.new(0, 18, 0, 150)
dbgBtn.BackgroundColor3 = Color3.fromRGB(170, 120, 70)
dbgBtn.Text = "Debug: OFF"
dbgBtn.TextColor3 = Color3.new(1,1,1)
dbgBtn.TextSize = 16
dbgBtn.Font = Enum.Font.SourceSansBold
Instance.new("UICorner", dbgBtn).CornerRadius = UDim.new(0, 10)

dbgBtn.MouseButton1Click:Connect(function()
    debugOn = not debugOn
    dbg.Visible = debugOn
    dbgBtn.Text = debugOn and "Debug: ON" or "Debug: OFF"
end)

scyllaBtn.MouseButton1Click:Connect(function()
    scyllaModeOn = not scyllaModeOn
    if scyllaModeOn then
        auroraModeOn = false
        auroraBtn.Text = "üåå Aurora Mode : OFF"; auroraBtn.BackgroundColor3 = Color3.fromRGB(40,140,70)
        scyllaBtn.Text = "‚öîÔ∏è Scylla Mode : ON";  scyllaBtn.BackgroundColor3 = Color3.fromRGB(80,180,60)
        log("‚ñ∂Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î Scylla Mode")
    else
        scyllaBtn.Text = "‚öîÔ∏è Scylla Mode : OFF"; scyllaBtn.BackgroundColor3 = Color3.fromRGB(55,55,55)
        log("‚èπ ‡∏õ‡∏¥‡∏î Scylla Mode")
    end
end)

auroraBtn.MouseButton1Click:Connect(function()
    auroraModeOn = not auroraModeOn
    if auroraModeOn then
        scyllaModeOn = false
        scyllaBtn.Text = "‚öîÔ∏è Scylla Mode : OFF"; scyllaBtn.BackgroundColor3 = Color3.fromRGB(55,55,55)
        auroraBtn.Text = "üåå Aurora Mode : ON";  auroraBtn.BackgroundColor3 = Color3.fromRGB(80,180,60)
        log("‚ñ∂Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î Aurora Mode")
    else
        auroraBtn.Text = "üåå Aurora Mode : OFF"; auroraBtn.BackgroundColor3 = Color3.fromRGB(40,140,70)
        log("‚èπ ‡∏õ‡∏¥‡∏î Aurora Mode")
    end
end)

--========================
-- PAGE PLACEHOLDER ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢‡πÄ‡∏õ‡πä‡∏∞)
--========================
local function simpleLabel(p, txt)
    local l = Instance.new("TextLabel", p)
    l.Size = UDim2.new(1, -36, 1, -20)
    l.Position = UDim2.new(0, 18, 0, 8)
    l.BackgroundTransparency = 1
    l.Text = txt
    l.TextXAlignment = Enum.TextXAlignment.Left
    l.Font = Enum.Font.SourceSansBold
    l.TextSize = 18
    l.TextColor3 = Color3.fromRGB(120, 90, 40)
end
simpleLabel(tabFrames["‡πÄ‡∏°‡πá‡∏Å‡∏Å‡∏≤‡πÇ‡∏•‡∏î‡πâ‡∏ß‡∏ô"], "‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï")
simpleLabel(tabFrames["‡∏ã‡∏±‡∏ô‡πÑ‡∏≠‡∏î‡∏≠"], "‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï")
simpleLabel(tabFrames["‡∏´‡∏°‡∏∂‡∏Å‡∏¢‡πä‡∏≤‡∏Å‡∏´‡∏°‡∏∂‡∏Å‡∏õ‡∏µ‡∏®‡∏≤‡∏à"], "‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï")

--========================
-- ROBUST SCYLLA DETECTOR (‡∏î‡∏±‡∏î‡πÅ‡∏õ‡∏•‡∏á‡∏™‡πÑ‡∏ï‡∏•‡πå Fisch)
--========================
local currentScyllaRef = nil

local function isLikelyScyllaContainer(m)
    if not m or not m.Name then return false end
    local n = string.lower(m.Name)
    if not n:find("scylla") then return false end
    if n:find("template") or n:find("dummy") or n:find("preview") or n:find("icon") or n:find("ui") then
        return false
    end
    -- ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Model/Folder ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£
    local container = m
    if not (container:IsA("Model") or container:IsA("Folder")) then return false end
    local parts = 0
    for _, d in ipairs(container:GetDescendants()) do
        if d:IsA("BasePart") then
            parts += 1
            if parts >= 5 then break end
        end
    end
    return parts >= 5
end

local function findScylla()
    -- ‡∏Ñ‡πâ‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤
    for _, c in ipairs(workspace:GetChildren()) do
        if isLikelyScyllaContainer(c) then return c end
        -- ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Å‡∏•‡∏≤‡∏á
        if c:IsA("Folder") or c:IsA("Model") then
            for _, d in ipairs(c:GetChildren()) do
                if isLikelyScyllaContainer(d) then return d end
            end
        end
    end
    return nil
end

local function setScyllaActive(active, ref)
    if scyllaActive == active then return end
    scyllaActive = active
    currentScyllaRef = active and ref or nil
    if active then
        log("üêâ ‡∏û‡∏ö Scylla (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•)")
    else
        log("üåÄ Scylla ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß")
    end
end

-- ‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏£‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏° + ‡∏ü‡∏±‡∏á event
local function rescanOnce()
    local hit = findScylla()
    setScyllaActive(hit ~= nil, hit)
end
rescanOnce()

local throttleT = 0
workspace.DescendantAdded:Connect(function(obj)
    -- ‡∏Å‡∏±‡∏ô‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏£‡πà‡∏≥‡πÄ‡∏û‡∏£‡∏∑‡πà‡∏≠: 0.25 ‡∏ß‡∏¥
    if (now() - throttleT) < 0.25 then return end
    throttleT = now()
    if obj and obj.Name and string.find(string.lower(obj.Name), "scylla") then
        rescanOnce()
    end
end)
workspace.DescendantRemoving:Connect(function(obj)
    if (now() - throttleT) < 0.25 then return end
    throttleT = now()
    if obj and obj.Name and string.find(string.lower(obj.Name), "scylla") then
        rescanOnce()
    end
end)

--========================
-- TIME (Day/Night) ‡∏à‡∏≤‡∏Å RS.cycle_weatherstimeofday (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
--========================
task.spawn(function()
    local ok, v = pcall(function() return RS:WaitForChild("cycle_weatherstimeofday", 5) end)
    if ok and v and v:IsA("StringValue") then
        cycleValue = v
        isDay = (v.Value == "Day")
        v.Changed:Connect(function(newVal)
            isDay = (newVal == "Day")
            log("‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô: " .. tostring(newVal))
        end)
    end
end)

local function isNightNow()
    if cycleValue then
        local s = cycleValue.Value
        return (s == "Night") or (s == "Both") -- Both ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö Aurora
    end
    return not isDay
end

--========================
-- MAIN LOGIC LOOP
--========================
task.spawn(function()
    while gui.Parent do
        -- SCYLLA MODE (‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤: base ‡∏à‡∏≤‡∏Å Fisch, ‡πÑ‡∏°‡πà spam)
        if scyllaModeOn then
            if not scyllaActive then
                useItem(NAME_SUNDIAL)
                log("üîÑ ‡πÑ‡∏°‡πà‡∏°‡∏µ Scylla ‚Üí ‡πÉ‡∏ä‡πâ Sundial")
            else
                equipItem(KEYWORD_ROD)
                log("üé£ ‡∏û‡∏ö Scylla ‚Üí ‡∏ñ‡∏∑‡∏≠ Rod")
                repeat task.wait(0.2) until (not scyllaModeOn) or (not scyllaActive)
            end
        end

        -- AURORA MODE (‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏ä‡∏±‡∏ö)
        if auroraModeOn then
            if not scyllaActive then
                useItem(NAME_SUNDIAL)
                log("(Aurora) üîÑ ‡πÑ‡∏°‡πà‡∏°‡∏µ Scylla ‚Üí ‡πÉ‡∏ä‡πâ Sundial")
            else
                log("(Aurora) ‚è∏ ‡∏û‡∏ö Scylla ‚Üí ‡∏´‡∏¢‡∏∏‡∏î 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ß‡∏•‡∏≤")
                task.wait(15)

                if not isNightNow() then
                    log("(Aurora) ‚òÄÔ∏è ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô ‚Üí ‡πÉ‡∏ä‡πâ Sundial 1 ‡∏£‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô")
                    useItem(NAME_SUNDIAL)
                    -- ‡∏£‡∏≠‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô (‡πÄ‡∏ä‡πá‡∏Ñ‡∏ó‡∏∏‡∏Å 0.5 ‡∏ß‡∏¥ ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ~20 ‡∏ß‡∏¥)
                    local t0 = now()
                    repeat task.wait(0.5) until isNightNow() or (now() - t0) > 20
                    if isNightNow() then
                        log("(Aurora) üåô ‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÉ‡∏ä‡πâ Aurora Totem + ‡∏ñ‡∏∑‡∏≠ Rod")
                        useItem(NAME_AURORA)
                        equipItem(KEYWORD_ROD)
                    else
                        log("(Aurora) ‚ö†Ô∏è ‡∏£‡∏≠‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô")
                    end
                else
                    log("(Aurora) üåô ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÉ‡∏ä‡πâ Aurora Totem + ‡∏ñ‡∏∑‡∏≠ Rod")
                    useItem(NAME_AURORA)
                    equipItem(KEYWORD_ROD)
                end

                -- ‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡∏ô Scylla ‡∏´‡∏≤‡∏¢/‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î
                repeat task.wait(0.2) until (not auroraModeOn) or (not scyllaActive)
            end
        end

        task.wait(0.5)
    end
end)

--========================================================
-- END
--========================================================
