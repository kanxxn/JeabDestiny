--========================================================
-- üê• Jeab Hub | V.1  (Small UI + Robust Scylla Detect + Mobile Drag)
-- Single-File (UI + Logic Scylla/Aurora + Dual Debug Panels)
--========================================================

--========================
-- Services & Locals
--========================
local Players  = game:GetService("Players")
local RS       = game:GetService("ReplicatedStorage")
local UIS      = game:GetService("UserInputService")
local LP       = Players.LocalPlayer

--========================
-- CONFIG
--========================
local NAME_SUNDIAL = "Sundial Totem"
local NAME_AURORA  = "Aurora Totem"
local KEYWORD_ROD  = "Rod Of The Zenith"

--========================
-- STATE
--========================
local scyllaModeOn   = false
local auroraModeOn   = false

local scyllaActive   = false               -- ‡∏û‡∏ö Scylla ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•
local cycleValue     = nil                 -- RS.cycle_weatherstimeofday (Day/Night/Both)
local isDayFallback  = true                -- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ cycle ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô

-- Debug state (‡πÅ‡∏¢‡∏Å 2 ‡∏ä‡∏∏‡∏î)
local debugScyllaOn  = false
local debugAuroraOn  = false

-- ‡∏Å‡∏±‡∏ô‡∏™‡πÅ‡∏õ‡∏° log ‡πÅ‡∏¢‡∏Å‡πÇ‡∏´‡∏°‡∏î
local lastScyllaLog, lastScyllaLogTime = "", 0
local lastAuroraLog, lastAuroraLogTime = "", 0
local function now() return os.clock() end

--========================
-- UTIL: Equip / Use
--========================
local function equipItem(keyword)
    local char = LP.Character or LP.CharacterAdded:Wait()
    local hum  = char:WaitForChild("Humanoid")

    local tool = char:FindFirstChildOfClass("Tool")
    if tool and string.find(tool.Name, keyword) then
        return true
    end

    local bp = LP:WaitForChild("Backpack")
    for _, t in ipairs(bp:GetChildren()) do
        if t:IsA("Tool") and string.find(t.Name, keyword) then
            hum:EquipTool(t)
            return true
        end
    end
    return false
end

local function useItem(namePart)
    local char = LP.Character or LP.CharacterAdded:Wait()
    local hum  = char:WaitForChild("Humanoid")

    local tool = char:FindFirstChildOfClass("Tool")
    if tool and string.find(tool.Name, namePart) then
        tool:Activate()
        return true
    end

    local bp = LP:WaitForChild("Backpack")
    for _, t in ipairs(bp:GetChildren()) do
        if t:IsA("Tool") and string.find(t.Name, namePart) then
            hum:EquipTool(t)
            task.wait()
            t:Activate()
            return true
        end
    end
    return false
end

--========================
-- UI: Screen + Main (‡∏¢‡πà‡∏≠‡∏™‡πÄ‡∏Å‡∏•)
--========================
local gui = Instance.new("ScreenGui")
gui.Name = "JeabHub"
gui.ResetOnSpawn = false
gui.Parent = LP:WaitForChild("PlayerGui")

-- ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏•‡πÇ‡∏Å‡πâ üê• (‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏•‡∏≠‡∏î ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Hub)
local logoBtn = Instance.new("TextButton")
logoBtn.Parent = gui
logoBtn.Size = UDim2.new(0, 44, 0, 44)
logoBtn.Position = UDim2.new(0, 10, 0.5, -22)
logoBtn.Text = "üê•"
logoBtn.TextSize = 26
logoBtn.BackgroundTransparency = 1
logoBtn.BorderSizePixel = 0
logoBtn.ZIndex = 50
logoBtn.AutoButtonColor = true

-- ‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å (3 ‡πÇ‡∏ã‡∏ô)
local main = Instance.new("Frame")
main.Parent = gui
main.Size = UDim2.new(0, 480, 0, 280) -- ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏û‡∏≠‡∏î‡∏µ‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
main.Position = UDim2.new(0.5, -240, 0.48, -140)
main.BackgroundColor3 = Color3.fromRGB(255, 232, 180)  -- ‡πÇ‡∏ó‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≠‡πà‡∏≠‡∏ô
main.BackgroundTransparency = 0.08
main.BorderSizePixel = 0
main.Active = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 12)

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö mobile-friendly
local function makeDraggable(panel, handle)
    handle = handle or panel
    local dragging, dragStart, startPos = false, nil, nil

    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = panel.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)

    handle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement
        or input.UserInputType == Enum.UserInputType.Touch then
            if dragging then
                local delta = input.Position - dragStart
                panel.Position = UDim2.new(
                    startPos.X.Scale, startPos.X.Offset + delta.X,
                    startPos.Y.Scale, startPos.Y.Offset + delta.Y
                )
            end
        end
    end)
end

-- Top bar (‡πÇ‡∏ó‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏•, ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏°‡∏µ padding)
local top = Instance.new("Frame", main)
top.Size = UDim2.new(1, 0, 0, 40)
top.BackgroundColor3 = Color3.fromRGB(255, 208, 140) -- ‡πÇ‡∏ã‡∏ô 1
top.BackgroundTransparency = 0.06
top.BorderSizePixel = 0
local pad = Instance.new("UIPadding", top); pad.PaddingLeft = UDim.new(0, 12)

local title = Instance.new("TextLabel", top)
title.Size = UDim2.new(1, -12, 1, 0)
title.BackgroundTransparency = 1
title.TextXAlignment = Enum.TextXAlignment.Left
title.Text = "Jeab Hub | V.1"
title.Font = Enum.Font.SourceSansBold
title.TextSize = 20
title.TextColor3 = Color3.fromRGB(90, 60, 20)

makeDraggable(main, top) -- ‡∏¢‡πâ‡∏≤‡∏¢ Hub ‡πÑ‡∏î‡πâ

-- toggle ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÇ‡∏•‡πÇ‡∏Å‡πâ
logoBtn.MouseButton1Click:Connect(function()
    main.Visible = not main.Visible
end)

-- ‡πÇ‡∏ã‡∏ô 2: Sidebar (‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà)
local left = Instance.new("Frame", main)
left.Size = UDim2.new(0, 130, 1, -40)
left.Position = UDim2.new(0, 0, 0, 40)
left.BackgroundColor3 = Color3.fromRGB(255, 215, 150) -- ‡πÇ‡∏ã‡∏ô 2
left.BackgroundTransparency = 0.06
left.BorderSizePixel = 0
local leftPad = Instance.new("UIPadding", left); leftPad.PaddingTop = UDim.new(0, 8)

local leftScroll = Instance.new("ScrollingFrame", left)
leftScroll.Size = UDim2.new(1, 0, 1, -8)
leftScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
leftScroll.BorderSizePixel = 0
leftScroll.BackgroundTransparency = 1
leftScroll.ScrollBarThickness = 6

local leftList = Instance.new("UIListLayout", leftScroll)
leftList.Padding = UDim.new(0, 6)
leftList.SortOrder = Enum.SortOrder.LayoutOrder
leftList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    leftScroll.CanvasSize = UDim2.new(0,0,0,leftList.AbsoluteContentSize.Y + 8)
end)

-- ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á
local divider = Instance.new("Frame", main)
divider.Size = UDim2.new(0, 2, 1, -40)
divider.Position = UDim2.new(0, 130, 0, 40)
divider.BackgroundColor3 = Color3.fromRGB(190, 150, 90)
divider.BackgroundTransparency = 0.15
divider.BorderSizePixel = 0

-- ‡πÇ‡∏ã‡∏ô 3: Content
local content = Instance.new("Frame", main)
content.Size = UDim2.new(1, -132, 1, -40)
content.Position = UDim2.new(0, 132, 0, 40)
content.BackgroundColor3 = Color3.fromRGB(255, 240, 210) -- ‡πÇ‡∏ã‡∏ô 3
content.BackgroundTransparency = 0.08
content.BorderSizePixel = 0

--========================
-- DEBUG PANEL (2 ‡∏ä‡∏∏‡∏î ‡πÅ‡∏¢‡∏Å Scylla / Aurora)
--========================
local function makeDebugPanel(titleText, anchorPos)
    local dbg = Instance.new("Frame", gui)
    dbg.Size = UDim2.new(0, 320, 0, 200)
    dbg.Position = anchorPos or UDim2.new(0.60, 0, 0.18, 0)
    dbg.BackgroundColor3 = Color3.fromRGB(255, 232, 190)
    dbg.BackgroundTransparency = 0.08
    dbg.Visible = false
    dbg.BorderSizePixel = 0
    Instance.new("UICorner", dbg).CornerRadius = UDim.new(0, 10)
    makeDraggable(dbg)

    local topBar = Instance.new("Frame", dbg)
    topBar.Size = UDim2.new(1, 0, 0, 32)
    topBar.BackgroundColor3 = Color3.fromRGB(255, 206, 140)
    topBar.BackgroundTransparency = 0.06
    topBar.BorderSizePixel = 0

    local lbl = Instance.new("TextLabel", topBar)
    lbl.Size = UDim2.new(1, -10, 1, 0)
    lbl.Position = UDim2.new(0, 10, 0, 0)
    lbl.BackgroundTransparency = 1
    lbl.Text = titleText
    lbl.Font = Enum.Font.SourceSansBold
    lbl.TextSize = 16
    lbl.TextColor3 = Color3.fromRGB(90, 60, 20)
    lbl.TextXAlignment = Enum.TextXAlignment.Left

    local copyBtn = Instance.new("TextButton", topBar)
    copyBtn.Size = UDim2.new(0, 64, 0, 24)
    copyBtn.Position = UDim2.new(1, -74, 0.5, -12)
    copyBtn.Text = "Copy"
    copyBtn.Font = Enum.Font.SourceSansBold
    copyBtn.TextSize = 14
    copyBtn.TextColor3 = Color3.new(1,1,1)
    copyBtn.BackgroundColor3 = Color3.fromRGB(100,180,100)
    Instance.new("UICorner", copyBtn).CornerRadius = UDim.new(0, 8)

    local scroll = Instance.new("ScrollingFrame", dbg)
    scroll.Size = UDim2.new(1, -8, 1, -40)
    scroll.Position = UDim2.new(0, 4, 0, 36)
    scroll.BackgroundTransparency = 1
    scroll.ScrollBarThickness = 6
    scroll.CanvasSize = UDim2.new(0,0,0,0)

    local list = Instance.new("UIListLayout", scroll)
    list.SortOrder = Enum.SortOrder.LayoutOrder
    list.Padding = UDim.new(0, 2)
    list:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        scroll.CanvasSize = UDim2.new(0,0,0,list.AbsoluteContentSize.Y + 6)
    end)

    local buffer, MAX_LOG = {}, 150
    local function push(text)
        table.insert(buffer, text)
        if #buffer > MAX_LOG then
            table.remove(buffer,1)
            local first = scroll:FindFirstChildWhichIsA("TextLabel"); if first then first:Destroy() end
        end
        local line = Instance.new("TextLabel")
        line.Size = UDim2.new(1, -4, 0, 18)
        line.BackgroundTransparency = 1
        line.TextXAlignment = Enum.TextXAlignment.Left
        line.Font = Enum.Font.SourceSans
        line.TextSize = 15
        line.TextColor3 = Color3.fromRGB(70, 50, 30)
        line.Text = text
        line.Parent = scroll
        scroll.CanvasPosition = Vector2.new(0, math.max(0, scroll.AbsoluteCanvasSize.Y - scroll.AbsoluteWindowSize.Y))
    end

    copyBtn.MouseButton1Click:Connect(function()
        if setclipboard then setclipboard(table.concat(buffer,"\n")); push("Debug copied.") else push("setclipboard ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ") end
    end)

    return dbg, push
end

local dbgScyllaFrame, dbgScyllaPush = makeDebugPanel("üîé Scylla Debug Log",  UDim2.new(0.58, 0, 0.16, 0))
local dbgAuroraFrame, dbgAuroraPush = makeDebugPanel("üîé Aurora Debug Log",  UDim2.new(0.58, 0, 0.50, 0))

local function logScylla(msg)
    -- ‡∏Å‡∏±‡∏ô‡∏™‡πÅ‡∏õ‡∏°: ‡∏ã‡πâ‡∏≥‡πÉ‡∏ô 1.2 ‡∏ß‡∏¥‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå
    if msg == lastScyllaLog and (now() - lastScyllaLogTime) < 1.2 then return end
    lastScyllaLog, lastScyllaLogTime = msg, now()
    if debugScyllaOn then dbgScyllaPush(msg) end
end
local function logAurora(msg)
    if msg == lastAuroraLog and (now() - lastAuroraLogTime) < 1.2 then return end
    lastAuroraLog, lastAuroraLogTime = msg, now()
    if debugAuroraOn then dbgAuroraPush(msg) end
end

--========================
-- Sidebar Tabs + Pages
--========================
local function makeTabButton(text)
    local b = Instance.new("TextButton")
    b.Parent = leftScroll
    b.Size = UDim2.new(1, -16, 0, 30)
    b.Position = UDim2.new(0, 8, 0, 0)
    b.BackgroundColor3 = Color3.fromRGB(255, 226, 176)
    b.BackgroundTransparency = 0.06
    b.Text = text
    b.Font = Enum.Font.SourceSansBold
    b.TextSize = 16
    b.TextColor3 = Color3.fromRGB(90, 60, 20)
    b.AutoButtonColor = true
    Instance.new("UICorner", b).CornerRadius = UDim.new(0, 8)
    return b
end

local tabs = {"‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ","‡πÄ‡∏°‡πá‡∏Å‡∏Å‡∏≤‡πÇ‡∏•‡∏î‡πâ‡∏ß‡∏ô","‡∏ã‡∏±‡∏ô‡πÑ‡∏≠‡∏î‡∏≠","‡∏´‡∏°‡∏∂‡∏Å‡∏¢‡πä‡∏≤‡∏Å‡∏´‡∏°‡∏∂‡∏Å‡∏õ‡∏µ‡∏®‡∏≤‡∏à"}
local tabFrames = {}
for _, name in ipairs(tabs) do
    local btn = makeTabButton(name)
    local page = Instance.new("Frame", content)
    page.Size = UDim2.new(1, 0, 1, 0)
    page.BackgroundTransparency = 1
    page.Visible = false
    tabFrames[name] = page
    btn.MouseButton1Click:Connect(function()
        for _, f in pairs(tabFrames) do f.Visible = false end
        page.Visible = true
    end)
end
tabFrames["‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ"].Visible = true

--========================
-- PAGE: ‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ
--========================
local scPage = tabFrames["‡∏™‡∏Å‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏ö‡∏π‡∏ö‡∏π‡πâ"]

local note = Instance.new("TextLabel", scPage)
note.Position = UDim2.new(0, 18, 0, 8)
note.Size = UDim2.new(1, -36, 0, 24)
note.BackgroundTransparency = 1
note.Text = "‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Rod Of The Zenith"
note.Font = Enum.Font.SourceSansItalic
note.TextSize = 16
note.TextColor3 = Color3.fromRGB(100, 80, 40)
note.TextXAlignment = Enum.TextXAlignment.Left

local function makeModeButton(parent, text, color, y)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(0, 300, 0, 44)
    btn.Position = UDim2.new(0, 18, 0, y)
    btn.BackgroundColor3 = color
    btn.TextColor3 = Color3.new(1,1,1)
    btn.TextSize = 18
    btn.Font = Enum.Font.SourceSansBold
    btn.Text = text
    btn.AutoButtonColor = true
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 12)
    return btn
end

-- ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏¢‡∏Å 2 ‡πÇ‡∏´‡∏°‡∏î (Scylla / Aurora)
local scyllaBtn = makeModeButton(scPage, "‚öîÔ∏è Scylla Mode : OFF", Color3.fromRGB(45,45,45), 42) -- OFF = ‡∏î‡∏≥
local auroraBtn = makeModeButton(scPage, "üåå Aurora Mode : OFF", Color3.fromRGB(45,45,45), 96) -- OFF = ‡∏î‡∏≥

-- ‡∏õ‡∏∏‡πà‡∏° Debug ‡πÅ‡∏¢‡∏Å 2 ‡∏≠‡∏±‡∏ô
local dbgScBtn = Instance.new("TextButton", scPage)
dbgScBtn.Size = UDim2.new(0, 145, 0, 36)
dbgScBtn.Position = UDim2.new(0, 18, 0, 150)
dbgScBtn.BackgroundColor3 = Color3.fromRGB(170, 120, 70)
dbgScBtn.Text = "Debug Scylla: OFF"
dbgScBtn.TextColor3 = Color3.new(1,1,1)
dbgScBtn.TextSize = 15
dbgScBtn.Font = Enum.Font.SourceSansBold
Instance.new("UICorner", dbgScBtn).CornerRadius = UDim.new(0, 10)

local dbgAuBtn = Instance.new("TextButton", scPage)
dbgAuBtn.Size = UDim2.new(0, 145, 0, 36)
dbgAuBtn.Position = UDim2.new(0, 173, 0, 150)
dbgAuBtn.BackgroundColor3 = Color3.fromRGB(170, 120, 70)
dbgAuBtn.Text = "Debug Aurora: OFF"
dbgAuBtn.TextColor3 = Color3.new(1,1,1)
dbgAuBtn.TextSize = 15
dbgAuBtn.Font = Enum.Font.SourceSansBold
Instance.new("UICorner", dbgAuBtn).CornerRadius = UDim.new(0, 10)

dbgScBtn.MouseButton1Click:Connect(function()
    debugScyllaOn = not debugScyllaOn
    dbgScyllaFrame.Visible = debugScyllaOn
    dbgScBtn.Text = debugScyllaOn and "Debug Scylla: ON" or "Debug Scylla: OFF"
end)
dbgAuBtn.MouseButton1Click:Connect(function()
    debugAuroraOn = not debugAuroraOn
    dbgAuroraFrame.Visible = debugAuroraOn
    dbgAuBtn.Text = debugAuroraOn and "Debug Aurora: ON" or "Debug Aurora: OFF"
end)

--========================
-- PAGE PLACEHOLDER ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ (‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢‡∏ï‡∏£‡∏á‡πÄ‡∏õ‡πä‡∏∞)
--========================
local function simpleLabel(p, txt)
    local l = Instance.new("TextLabel", p)
    l.Size = UDim2.new(1, -36, 1, -20)
    l.Position = UDim2.new(0, 18, 0, 8)
    l.BackgroundTransparency = 1
    l.Text = txt
    l.TextXAlignment = Enum.TextXAlignment.Left
    l.Font = Enum.Font.SourceSansBold
    l.TextSize = 18
    l.TextColor3 = Color3.fromRGB(120, 90, 40)
end
simpleLabel(tabFrames["‡πÄ‡∏°‡πá‡∏Å‡∏Å‡∏≤‡πÇ‡∏•‡∏î‡πâ‡∏ß‡∏ô"], "‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï")
simpleLabel(tabFrames["‡∏ã‡∏±‡∏ô‡πÑ‡∏≠‡∏î‡∏≠"], "‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï")
simpleLabel(tabFrames["‡∏´‡∏°‡∏∂‡∏Å‡∏¢‡πä‡∏≤‡∏Å‡∏´‡∏°‡∏∂‡∏Å‡∏õ‡∏µ‡∏®‡∏≤‡∏à"], "‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï")

--========================
-- Robust Scylla Detector (Fisch-style)
--========================
local currentScyllaRef = nil

local function isLikelyScyllaContainer(m)
    if not m or not m.Name then return false end
    local n = string.lower(m.Name)
    if not n:find("scylla") then return false end
    if n:find("template") or n:find("dummy") or n:find("preview") or n:find("icon") or n:find("ui") then
        return false
    end
    -- ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Model/Folder ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏≠‡∏™‡∏°‡∏Ñ‡∏ß‡∏£
    if not (m:IsA("Model") or m:IsA("Folder")) then return false end
    local parts = 0
    for _, d in ipairs(m:GetDescendants()) do
        if d:IsA("BasePart") then
            parts += 1
            if parts >= 5 then break end
        end
    end
    return parts >= 5
end

local function findScylla()
    -- ‡∏Ñ‡πâ‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤
    for _, c in ipairs(workspace:GetChildren()) do
        if isLikelyScyllaContainer(c) then return c end
        if c:IsA("Folder") or c:IsA("Model") then
            for _, d in ipairs(c:GetChildren()) do
                if isLikelyScyllaContainer(d) then return d end
            end
        end
    end
    return nil
end

local function setScyllaActive(active, ref)
    if scyllaActive == active then return end
    scyllaActive = active
    currentScyllaRef = active and ref or nil
    if active then
        logScylla("‡∏û‡∏ö Scylla (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•)")
        logAurora("‡∏û‡∏ö Scylla (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•)")
    else
        logScylla("Scylla ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß")
        logAurora("Scylla ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß")
    end
end

local function rescanOnce()
    local hit = findScylla()
    setScyllaActive(hit ~= nil, hit)
end
rescanOnce()

-- throttle event scan
local throttleT = 0
workspace.DescendantAdded:Connect(function(obj)
    if (now() - throttleT) < 0.25 then return end
    throttleT = now()
    if obj and obj.Name and string.find(string.lower(obj.Name), "scylla") then
        rescanOnce()
    end
end)
workspace.DescendantRemoving:Connect(function(obj)
    if (now() - throttleT) < 0.25 then return end
    throttleT = now()
    if obj and obj.Name and string.find(string.lower(obj.Name), "scylla") then
        rescanOnce()
    end
end)

--========================
-- TIME (Day/Night) ‡∏à‡∏≤‡∏Å RS.cycle_weatherstimeofday (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
--========================
task.spawn(function()
    local ok, v = pcall(function() return RS:WaitForChild("cycle_weatherstimeofday", 5) end)
    if ok and v and v:IsA("StringValue") then
        cycleValue = v
        isDayFallback = (v.Value == "Day")
        v.Changed:Connect(function(newVal)
            isDayFallback = (newVal == "Day")
            logScylla("‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô: " .. tostring(newVal))
            logAurora("‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô: " .. tostring(newVal))
        end)
    end
end)

local function isNightNow()
    if cycleValue then
        local s = cycleValue.Value
        -- Both = ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Aurora ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
        return (s == "Night") or (s == "Both")
    end
    return not isDayFallback
end

--========================
-- Buttons: Toggle Modes (‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°: OFF=‡∏î‡∏≥, ON=‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß)
--========================
scyllaBtn.MouseButton1Click:Connect(function()
    scyllaModeOn = not scyllaModeOn
    if scyllaModeOn then
        -- ‡∏õ‡∏¥‡∏î Aurora ‡πÄ‡∏™‡∏°‡∏≠ (‡πÅ‡∏¢‡∏Å‡πÇ‡∏´‡∏°‡∏î)
        auroraModeOn = false
        auroraBtn.Text = "üåå Aurora Mode : OFF"; auroraBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)

        scyllaBtn.Text = "‚öîÔ∏è Scylla Mode : ON";  scyllaBtn.BackgroundColor3 = Color3.fromRGB(80,180,60)
        logScylla("‡πÄ‡∏õ‡∏¥‡∏î Scylla Mode")
    else
        scyllaBtn.Text = "‚öîÔ∏è Scylla Mode : OFF"; scyllaBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)
        logScylla("‡∏õ‡∏¥‡∏î Scylla Mode")
    end
end)

auroraBtn.MouseButton1Click:Connect(function()
    auroraModeOn = not auroraModeOn
    if auroraModeOn then
        -- ‡∏õ‡∏¥‡∏î Scylla ‡πÄ‡∏™‡∏°‡∏≠ (‡πÅ‡∏¢‡∏Å‡πÇ‡∏´‡∏°‡∏î)
        scyllaModeOn = false
        scyllaBtn.Text = "‚öîÔ∏è Scylla Mode : OFF"; scyllaBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)

        auroraBtn.Text = "üåå Aurora Mode : ON";  auroraBtn.BackgroundColor3 = Color3.fromRGB(80,180,60)
        logAurora("‡πÄ‡∏õ‡∏¥‡∏î Aurora Mode")
    else
        auroraBtn.Text = "üåå Aurora Mode : OFF"; auroraBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)
        logAurora("‡∏õ‡∏¥‡∏î Aurora Mode")
    end
end)

--========================
-- MAIN LOGIC LOOP
--========================
task.spawn(function()
    while gui.Parent do
        -- ---------- Scylla Mode (Base ‡∏ï‡∏≤‡∏°‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÅ‡∏£‡∏Å / ‡πÑ‡∏°‡πà‡∏™‡πÅ‡∏õ‡∏°) ----------
        if scyllaModeOn then
            if not scyllaActive then
                useItem(NAME_SUNDIAL)
                logScylla("‡πÑ‡∏°‡πà‡∏°‡∏µ Scylla ‚Üí ‡πÉ‡∏ä‡πâ Sundial")
            else
                equipItem(KEYWORD_ROD)
                logScylla("‡∏û‡∏ö Scylla ‚Üí ‡∏ñ‡∏∑‡∏≠ Rod")
                -- ‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î
                repeat task.wait(0.2) until (not scyllaModeOn) or (not scyllaActive)
            end
        end

        -- ---------- Aurora Mode (‡∏•‡∏π‡∏õ‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î) ----------
        if auroraModeOn then
            if not scyllaActive then
                useItem(NAME_SUNDIAL)
                logAurora("‡πÑ‡∏°‡πà‡∏°‡∏µ Scylla ‚Üí ‡πÉ‡∏ä‡πâ Sundial")
            else
                logAurora("‡∏û‡∏ö Scylla ‚Üí ‡∏´‡∏¢‡∏∏‡∏î 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ß‡∏•‡∏≤")
                -- ‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥ 15 ‡∏ß‡∏¥
                local tStop = now()
                while auroraModeOn and scyllaActive and (now() - tStop) < 15 do
                    task.wait(0.2)
                end
                if not auroraModeOn or not scyllaActive then
                    -- ‡πÇ‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠ Scylla ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏≠ ‚Üí ‡∏Ç‡πâ‡∏≤‡∏°
                    goto _auroraLoopEnd
                end

                if not isNightNow() then
                    -- ‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô ‚Üí ‡πÉ‡∏ä‡πâ Sundial 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏£‡∏≠ 15 ‡∏ß‡∏¥ ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                    logAurora("‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô ‚Üí ‡πÉ‡∏ä‡πâ Sundial 1 ‡∏£‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô")
                    useItem(NAME_SUNDIAL)

                    local tWait = now()
                    while auroraModeOn and scyllaActive and (now() - tWait) < 15 do
                        task.wait(0.25)
                    end
                    if not auroraModeOn or not scyllaActive then
                        goto _auroraLoopEnd
                    end

                    -- ‡∏ï‡∏£‡∏ß‡∏à‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏à‡∏£‡∏¥‡∏á (‡∏£‡∏≠‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 20 ‡∏ß‡∏¥)
                    local t0 = now()
                    repeat task.wait(0.5)
                        if not auroraModeOn or not scyllaActive then break end
                    until isNightNow() or (now() - t0) > 20

                    if auroraModeOn and scyllaActive and isNightNow() then
                        logAurora("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÉ‡∏ä‡πâ Aurora Totem + ‡∏ñ‡∏∑‡∏≠ Rod")
                        useItem(NAME_AURORA)
                        equipItem(KEYWORD_ROD)
                    else
                        logAurora("‡∏£‡∏≠‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô")
                    end
                else
                    -- ‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
                    logAurora("‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÉ‡∏ä‡πâ Aurora Totem + ‡∏ñ‡∏∑‡∏≠ Rod")
                    useItem(NAME_AURORA)
                    equipItem(KEYWORD_ROD)
                end

                ::_auroraLoopEnd::
                -- ‡∏Ñ‡πâ‡∏≤‡∏á‡∏à‡∏ô Scylla ‡∏´‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î
                repeat task.wait(0.2) until (not auroraModeOn) or (not scyllaActive)
            end
        end

        task.wait(0.5)
    end
end)

--========================================================
-- END
--========================================================
