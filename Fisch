--// Auto Scylla Hunt Script (TextChatService Only) //--
-- Made By Jeab

local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local VirtualInputManager = game:GetService("VirtualInputManager")

local LocalPlayer = Players.LocalPlayer

-- ตั้งชื่อไอเท็ม
local sundialName = "Sundial Totem"
local auroraName = "Aurora Totem"
local rodName = "Blessed Rod Of The Zenith"

-- ตัวแปรสถานะ
local isRunning = false
local scyllaActive = false

-- ใช้ไอเท็มตามชื่อ
local function useItem(itemName)
    for i, v in ipairs(LocalPlayer.Backpack:GetChildren()) do
        if v.Name == itemName then
            LocalPlayer.Character.Humanoid:EquipTool(v)
            task.wait(0.2)
            VirtualInputManager:SendKeyEvent(true, "E", false, game)
            task.wait(0.1)
            VirtualInputManager:SendKeyEvent(false, "E", false, game)
            print("[DEBUG] ใช้ไอเท็ม:", itemName)
            break
        end
    end
end

-- loop หลัก
task.spawn(function()
    while true do
        if isRunning then
            if not scyllaActive then
                useItem(sundialName)
            else
                useItem(auroraName)
                task.wait(1)
                useItem(rodName)
                repeat task.wait() until not isRunning or not scyllaActive
            end
        end
        task.wait(0.5)
    end
end)

-- ✅ ใช้ TextChatService อ่านแชท
TextChatService.OnIncomingMessage = function(message)
    local msg = message.Text or ""
    print("[DEBUG CHAT] " .. msg)

    if string.find(msg, "Scylla Hunt has begun!") then
        scyllaActive = true
        print("[DEBUG] Scylla เริ่มแล้ว")
    elseif string.find(msg, "The Scylla got away") then
        scyllaActive = false
        print("[DEBUG] Scylla หนีไปแล้ว")
    elseif string.find(msg, "has caught the Scylla!") then
        scyllaActive = false
        print("[DEBUG] Scylla ถูกจับแล้ว")
    end
end

--// GUI //--
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local ToggleButton = Instance.new("TextButton")
local StopButton = Instance.new("TextButton")
local Credit = Instance.new("TextLabel")

ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.Position = UDim2.new(0.3, 0, 0.3, 0)
Frame.Size = UDim2.new(0, 200, 0, 120)
Frame.Active = true
Frame.Draggable = true

UICorner.Parent = Frame

ToggleButton.Parent = Frame
ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
ToggleButton.Size = UDim2.new(0, 160, 0, 40)
ToggleButton.Position = UDim2.new(0.5, -80, 0.2, 0)
ToggleButton.Text = "เปิดการทำงาน"
ToggleButton.TextColor3 = Color3.fromRGB(255,255,255)
ToggleButton.Font = Enum.Font.SourceSansBold
ToggleButton.TextSize = 18

StopButton.Parent = Frame
StopButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
StopButton.Size = UDim2.new(0, 160, 0, 30)
StopButton.Position = UDim2.new(0.5, -80, 0.55, 0)
StopButton.Text = "ปิดสคริปต์"
StopButton.TextColor3 = Color3.fromRGB(255,255,255)
StopButton.Font = Enum.Font.SourceSansBold
StopButton.TextSize = 16

Credit.Parent = Frame
Credit.BackgroundTransparency = 1
Credit.Size = UDim2.new(1, 0, 0.2, 0)
Credit.Position = UDim2.new(0, 0, 0.8, 0)
Credit.Text = "Made By Jeab"
Credit.TextColor3 = Color3.fromRGB(255,255,255)
Credit.Font = Enum.Font.SourceSansItalic
Credit.TextSize = 14

-- ปุ่มเปิด/ปิดการทำงาน
ToggleButton.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    if isRunning then
        ToggleButton.Text = "ปิดการทำงาน"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(170,0,0)
    else
        ToggleButton.Text = "เปิดการทำงาน"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(0,170,0)
    end
end)

-- ปุ่มปิดสคริปต์
StopButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
    isRunning = false
    scyllaActive = false
end)
