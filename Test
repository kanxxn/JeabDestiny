-- ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏≤‡∏Å GUI ‡πÄ‡∏î‡∏¥‡∏°
local ToggleBtn = Frame:WaitForChild("ToggleBtn")  -- ‡∏õ‡∏∏‡πà‡∏° Start/Stop
local MutationLabel = Frame:WaitForChild("MutationLabel") -- Text ‡πÅ‡∏™‡∏î‡∏á Mutation ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
local SlotBox = Frame:WaitForChild("SlotBox") -- ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà slot (9)

local isRunning = false
local firstYes = true
local targetMutation = "Albino"
local hotbarSlot = 9

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Reset
local function resetAll()
    isRunning = false
    firstYes = true
    ToggleBtn.Text = "Start"
    ToggleBtn.BackgroundColor3 = Color3.fromRGB(80,180,60)
    print("üîÑ Reset Complete: Ready for next run")
end

-- ‡∏´‡∏≤ TextButton ‡πÉ‡∏ô GUI ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏°
local function findButton(text)
    for _, gui in ipairs(game.Players.LocalPlayer.PlayerGui:GetDescendants()) do
        if gui:IsA("TextButton") and string.find(gui.Text, text) then
            return gui
        end
    end
end

-- ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°
local function clickButton(btn)
    if btn then
        game:GetService("VirtualInputManager"):SendMouseButtonEvent(0,0,0,true,btn,0)
        task.wait(0.1)
        game:GetService("VirtualInputManager"):SendMouseButtonEvent(0,0,0,false,btn,0)
    end
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å Auto Appraise
local function autoAppraise()
    task.spawn(function()
        while isRunning do
            task.wait(0.6)

            if firstYes then
                local appraiseBtn = findButton("Can you appraise this fish?")
                if appraiseBtn then clickButton(appraiseBtn) task.wait(0.5) end

                local yesBtn = findButton("Yes")
                if yesBtn then
                    clickButton(yesBtn)
                    firstYes = false
                    task.wait(1.2)
                end
            else
                local appraiseBtn = findButton("Can you appraise this fish?")
                if appraiseBtn then clickButton(appraiseBtn) task.wait(1.2) end
            end

            -- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö Mutation
            for _, gui in ipairs(game.Players.LocalPlayer.PlayerGui:GetDescendants()) do
                if gui:IsA("TextLabel") and string.find(string.lower(gui.Text), string.lower(targetMutation)) then
                    warn("üéâ Found Mutation:", targetMutation)
                    resetAll()
                    return
                end
            end
        end
    end)
end

-- Detect ‡∏ï‡∏≠‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏î E ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∏‡∏¢ NPC
game.Players.LocalPlayer.PlayerGui.DescendantAdded:Connect(function(obj)
    if isRunning and obj:IsA("TextLabel") and string.find(obj.Text, "Can you appraise this fish?") then
        print("‚ñ∂Ô∏è Auto Appraise Started")
        firstYes = true
        autoAppraise()
    end
end)

-- ‡∏õ‡∏∏‡πà‡∏° Start/Stop
ToggleBtn.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    if isRunning then
        ToggleBtn.Text = "Stop"
        ToggleBtn.BackgroundColor3 = Color3.fromRGB(220,80,40)
        print("‚úÖ Ready: Press E to talk NPC")
    else
        resetAll()
    end
end)
